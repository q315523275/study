{"version":3,"file":"p__forum-manage__group__models__model.js.d508b8d7.async.js","sources":["src/pages/forum-manage/group/models/model.js"],"sourcesContent":["import { message } from 'antd'\nimport {\n  getTreeNodeDataReq, deleteNodeReq, addNodeReq, groupEnable,groupDisable, queryGroupListReq, deleteGroup, updateNodeReq,\n} from '../api'\n\nexport default {\n  namespace: 'group',\n  state: {\n    treeData: [], // 树结构数据\n    groupListData: [], // 人员列表数据\n    pagination: { // Table分页配置项\n      current: 1,\n      pageSize: 10,\n      total: null,\n      showTotal: null,\n    },\n    query: {}, // 查询条件\n  },\n  effects: {\n    * getTreeNodeData({ params }, { call, put }) { // 获取树结构数据\n      const res = yield call(getTreeNodeDataReq, params)\n      yield put({\n        type: 'save',\n        payload: {\n          treeData:res,\n        },\n      })\n    },\n    * addTreeNodeData({ params,cb }, { call, put,select }) { // 添加\n      const {success} = yield call(addNodeReq, params)\n      if(success){\n        message.success('操作成功')\n        cb && cb()\n      }else{\n        message.error('操作失败')\n      }\n    },\n    * editTreeNodeData({ params,cb }, { call, put }) { // 编辑\n      const {success} = yield call(updateNodeReq, params)\n      if(success){\n        message.success('操作成功')\n        cb && cb()\n      }else{\n        message.error('操作失败')\n      }\n    },\n    * deleteTreeNodeData({ params,cb }, { call, put }) { // 删除\n      const {success} = yield call(deleteNodeReq, params)\n      if(success){\n        message.success('操作成功')\n        cb && cb()\n      }else{\n        message.error('操作失败')\n      }\n    },\n    * getGroupList({ params }, { call, put }) { // 获取子账号列表\n      const {\n         categoryId,\n      } = params\n      const res = yield call(queryGroupListReq, params)\n      const {\n        data, total, pageNumber, pageSize,\n      } = res\n      yield put({\n        type: 'save',\n        payload: {\n          groupListData: data,\n          pagination: {\n            current: pageNumber,\n            pageSize,\n            total,\n            showTotal: sum => `共 ${sum} 项`,\n          },\n          query: {\n            categoryId,\n          },\n        },\n      })\n    },\n    //启用/禁用\n    * groupEnableDisable({ params,state }, { call, put }) { \n      console.log(state)\n      const {success} =state? yield call(groupEnable, params):yield call(groupDisable, params)\n      if(success){\n        message.success('操作成功')\n      }else{\n        message.error('操作失败')\n      }\n    },\n     //删除\n     * deleteGroup({ params,cb }, { call, put }) { \n      const {success} = yield call(deleteGroup, params)\n      if(success){\n        message.success('操作成功')\n        cb&&cb()\n      }else{\n        message.error('操作失败')\n      }\n    },\n    *clearAll(_,{put}){\n      yield put({\n        type: 'save',\n        payload: {\n          treeData: [], // 树结构数据\n          groupListData: [], // 人员列表数据\n          pagination: { // Table分页配置项\n            current: 1,\n            pageSize: 10,\n            total: null,\n            showTotal: null,\n          },\n          query: {}, // 查询条件\n        },\n      })\n    }\n  },\n  reducers: {\n    save(state, { payload }) {\n      return {\n        ...state,\n        ...payload,\n      }\n    },\n  },\n}\n"],"mappings":"AAKA","sourceRoot":""}