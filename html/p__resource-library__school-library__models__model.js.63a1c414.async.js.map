{"version":3,"file":"p__resource-library__school-library__models__model.js.63a1c414.async.js","sources":["src/pages/resource-library/school-library/models/model.js"],"sourcesContent":["import { message } from 'antd'\nimport {\n  getListData, getDel, getDelArr, getCountryList, painedTop,unpainedTop\n} from '../api'\n\nexport default {\n  namespace: 'schoolLibrary',\n  state: {\n    listData: [], // 数据\n    countryList: [],\n    countryListJson: {},\n    query: {},\n  },\n  effects: {\n    * getCountryList({ params }, { call, put }) {\n      const countryList = yield call(getCountryList, params)\n      const countryListJson = {}\n      countryList.map((item) => {\n        countryListJson[item.countryId] = item\n      })\n      yield put({\n        type: 'save',\n        payload: {\n          countryList,\n          countryListJson,\n        },\n      })\n    },\n    // 获取数据\n    * getListData({ params }, { call, put }) {\n      const res = yield call(getListData, params)\n      const {\n        data, total, pageNumber, pageSize,\n      } = res\n      delete params.pageNumber\n      delete params.pageSize\n      yield put({\n        type: 'save',\n        payload: {\n          listData: data || [],\n          pagination: {\n            current: pageNumber,\n            pageSize,\n            total,\n            showTotal: sum => `共 ${sum} 项`,\n          },\n          query: {\n            ...params,\n          },\n        },\n      })\n    },\n\n    // 删除\n    * getDel({ params, cb }, { call, put }) {\n      const res = yield call(getDel, params)\n      console.log(res)\n      if (res.success) {\n        message.success('操作成功')\n        cb && cb()\n      } else {\n        message.error('操作失败')\n      }\n    },\n\n    // 删除多个\n    * getDelArr({ params, cb }, { call, put }) {\n      const res = yield call(getDelArr, params)\n      if (res.success) {\n        message.success('操作成功')\n        cb && cb()\n      } else {\n        message.error('操作失败')\n      }\n    },\n    * pained({ params, cb }, { call, put }) {\n      params.resource = 'university'\n      console.log(params)\n      const res = yield call(painedTop, params)\n      if (res.success) {\n        message.success('操作成功')\n        cb && cb()\n      } else {\n        message.error('操作失败')\n      }\n    },\n    * unpained({ params, cb }, { call, put }) {\n      params.resource = 'university'\n      console.log(params)\n      const res = yield call(unpainedTop, params)\n      if (res.success) {\n        message.success('操作成功')\n        cb && cb()\n      } else {\n        message.error('操作失败')\n      }\n    },\n    // 清空缓存\n    * clearAll({ params }, { put }) {\n      yield put({\n        type: 'save',\n        payload: {\n          listData: [], // 数据\n          countryList: [],\n          countryListJson: {},\n          query: {},\n        },\n      })\n    },\n\n\n  },\n  reducers: {\n    save(state, { payload }) {\n      return {\n        ...state,\n        ...payload,\n      }\n    },\n  },\n}\n"],"mappings":"AAKA","sourceRoot":""}